// Generated by CoffeeScript 1.6.2
(function() {
  define(["backbone", "underscore"], function() {
    var LayoutView;

    LayoutView = Backbone.View.extend({
      initialize: function() {
        _.bindAll(this);
        this.$el = $(this.el);
        this.total = 0;
        this.model = new Backbone.Model(JSON.parse(this.$('.data').html()));
        this.model.set('images', _.shuffle(this.model.get('images')));
        _.each(this.model.get('images'), this.addCell);
        this.makeGrid();
      },
      template: _.template("<div class=\"cell\">\n	<div class=\"image\" style=\"background-image:url('/assets/img/lookwork/<%= arguments[0] %>');\"></div>\n</div>"),
      sizes: ["square-1col", "square-2col", "square-3col", "portrait-2col", "landscape-3col"],
      addCell: function(img) {
        var cell, size;

        cell = $(this.template(img));
        size = this.sizes[Math.floor(Math.random() * this.sizes.length)];
        console.log(size);
        cell.addClass(size);
        this.$el.append(cell);
        this.columnWidth = 130;
        this.marginWidth = 20;
      },
      makeGrid: function() {
        $('#grid').isotope({
          masonry: {
            columnWidth: this.columnWidth + this.marginWidth
          }
        });
      }
    });
    return LayoutView;
  });

}).call(this);
